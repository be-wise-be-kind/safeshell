# Purpose: AI navigation index for SafeShell repository
# Scope: Repository structure, available resources, commands, and documentation
# Overview: Provides AI agents with a quick reference to navigate the SafeShell repository,
#     locate key files, understand available commands, and access documentation.

version: "1.0"
project:
  name: safeshell
  type: python-cli
  purpose: Command-line safety layer for AI coding assistants that intercepts shell commands and enforces configurable policies
  status: in-development
  version: "0.1.0"

core_documents:
  - file: .ai/ai-context.md
    description: Development patterns, architecture, and conventions
  - file: .ai/ai-rules.md
    description: Quality gates, coding standards, and mandatory rules

structure:
  source:
    location: src/
    description: Main source code for SafeShell CLI and daemon

  tests:
    location: tests/
    description: Test files

  docs:
    location: docs/
    description: User-facing documentation

  ai_navigation:
    location: .ai/
    description: AI agent navigation and context

documentation:
  location: .ai/docs/
  files:
    - PROJECT_CONTEXT.md
    - PYTHON_STANDARDS.md
    - file-header-format.md

howtos:
  location: .ai/howtos/
  files:
    - how-to-roadmap.md
    - how-to-write-file-headers.md
    - how-to-use-safeshell-cli.md
    - how-to-write-rules.md
    - how-to-fix-linting-errors.md
    - how-to-debug-rules.md
    - how-to-understand-rule-evaluation.md
    - how-to-add-condition-types.md
    - how-to-add-cli-commands.md

templates:
  location: .ai/templates/
  files:
    - roadmap-progress-tracker.md.template
    - roadmap-pr-breakdown.md.template
    - roadmap-ai-context.md.template
    - file-header-python.template

roadmaps:
  location: .roadmap/
  guide: .ai/howtos/how-to-roadmap.md

  structure:
    planning: .roadmap/planning/
    in_progress: .roadmap/in-progress/
    complete: .roadmap/complete/

  templates:
    progress_tracker: .ai/templates/roadmap-progress-tracker.md.template
    pr_breakdown: .ai/templates/roadmap-pr-breakdown.md.template
    ai_context: .ai/templates/roadmap-ai-context.md.template

  three_document_structure:
    - PROGRESS_TRACKER.md (required - primary handoff)
    - PR_BREAKDOWN.md (required for multi-PR)
    - AI_CONTEXT.md (optional - architecture)

commands:
  # Using justfile (not Makefile)
  init: just init
  install: just install
  test: just test
  test-coverage: just test-coverage
  lint: just lint
  lint-all: just lint-all
  lint-security: just lint-security
  lint-complexity: just lint-complexity
  lint-thai: just lint-thai
  lint-full: just lint-full
  format: just format
  clean: just clean
  docker-build: just docker-build
  docker-run: just docker-run
  run: just run

installed_plugins:
  - name: foundation/ai-folder
    status: installed
    provides: .ai/ directory structure, AGENTS.md
  - name: foundation/roadmap
    status: installed
    provides: .roadmap/ structure, howtos, templates, AGENTS.md roadmap detection
  - name: languages/python
    status: installed
    provides: pyproject.toml, Ruff, MyPy, Bandit, pytest, Pylint, radon
  - name: infrastructure/docker
    status: installed
    provides: Dockerfile, docker-compose.yml
  - name: infrastructure/github-actions
    status: installed
    provides: .github/workflows/lint.yml, .github/workflows/test.yml
  - name: standards/security
    status: installed
    provides: .gitignore with security patterns
  - name: standards/pre-commit
    status: installed
    provides: .pre-commit-config.yaml

key_files:
  readme: README.md
  gitignore: .gitignore
  agents: AGENTS.md

architecture:
  pattern: cli-daemon
  components:
    - shell_wrapper: Intercepts commands from AI tools
    - daemon: Loads rules and evaluates policy
    - monitor: TUI for real-time visibility and approval
    - rules: YAML-based policy configuration

notes_for_agents:
  - SafeShell uses three-layer interception (shims, shell functions, wrapper)
  - Policy logic is defined in YAML rules with structured Python conditions
  - Rules use fast-path optimization (commands not in index skip evaluation)
  - Uses Typer CLI framework with Rich for TUI
  - Build system uses justfile (not Makefile)
  - Thai-lint integrated for code quality checks
  - Use plumbum for shell execution (NOT subprocess)
  - Use Pydantic BaseModel for all data classes (NOT dataclass)
